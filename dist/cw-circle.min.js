"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,i){for(var a=0;a<i.length;a++){var e=i[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,a,e){return a&&t(i.prototype,a),e&&t(i,e),i}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var DrawCircle=function(){function t(i,a,e,s){_classCallCheck(this,t),i&&a&&e?(this.canvas=document.querySelector(i),this.ctx=this.canvas.getContext("2d"),this.data=a||[],this.accuracy=e||0,this.dataObj=s,this.init()):alert("id, data, accuracy 为必填参数")}return _createClass(t,[{key:"getRatio",value:function(){var t=window.devicePixelRatio||1;this.ratio=window.innerWidth>700?t:1}},{key:"init",value:function(){this.outer_colors=this.dataObj.outer_colors||["#52cc8f","#5499cc","#ff6969","#ffc869","#b66eff","#66cb8e","#c50e18"],this.inner_colors=this.dataObj.inner_colors||["#219c4b","#22559c","#ff2e2e","#ff952e","#7e34fe","#3b9b4a","#99080f"],this.center_text=this.dataObj.center_text||"正确率",this.start=0,this.sum=0,this.count=0,this.space=0,this.x=0,this.y=0,this.list=this.dataObj.list||["正   确","半   对","错   误","待批改","其它"],this.def_Color=this.dataObj.def_Color||"#2c333d",this.getRatio(),this.dataCount();var t=window.innerWidth;this.canvas.width=t,this.canvas.height=t-130*this.ratio,this.x=t/3,this.y=t/3,this.formatParams(this.outer_colors,this.canvas.width/4),this.formatParams(this.inner_colors,this.canvas.width/6),this.drawCenter(),this.computeSpace(),this.drawText(this.outer_colors)}},{key:"drawCenter",value:function(){var t=this.x,i=this.y,a=this.ctx,e=this.canvas.width/8;this.drawCircle(this.def_Color,0,1,e,t,i),a.font=28*this.ratio+"px Arial",a.fillStyle="#fff",a.textAlign="center",a.fillText(this.accuracy,t,i-10*this.ratio),a.font=22*this.ratio+"px Arial",a.fillText(this.center_text,t,i+20*this.ratio)}},{key:"drawText",value:function(t){var i=this,a=this.ctx,e=!1;this.data.map(function(s,r){var c=e?r-1:r;if(s&&s>0){var n=t[c]||t[1],o=i.list[r]||"其它",h=2*i.x,l=i.y-i.canvas.width/4+i.space+c*i.space*2;i.drawCircle(n,0,1,8*i.ratio,h,l),a.fillStyle="#fff",a.font=17*i.ratio+"px Arial",a.fillText(o+" "+s+"人",h+60*i.ratio,l+6*i.ratio)}else e=!0})}},{key:"computeSpace",value:function(){var t=this.canvas.width/4*2;this.space=t/(2*this.count)}},{key:"formatParams",value:function(t,i){var a=this,e=!1;this.data.map(function(s,r){var c=t[e?r-1:r]||t[1],n=s/a.sum;s&&s>0?(a.drawCircle(c,a.start,a.start+n,i,a.x,a.y),a.start+=s/a.sum):e=!0})}},{key:"drawCircle",value:function(t,i,a,e,s,r){var c=this.ctx;c.beginPath(),c.lineWidth=0,c.moveTo(s,r),c.arc(s,r,e,2*Math.PI*i,2*Math.PI*a),c.fillStyle=t,c.lineTo(s,r),c.fill(),c.save()}},{key:"dataCount",value:function(){var t=this;this.data=this.data.slice(0,this.list.length),this.data.map(function(i){t.sum+=i,i&&i>0&&t.count++})}}]),t}();exports.default=DrawCircle;