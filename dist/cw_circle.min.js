!function(t,i){if("function"==typeof define&&define.amd)define(["exports"],i);else if("undefined"!=typeof exports)i(exports);else{var e={};i(e),t.DrawCircle=e}}(this,function(a){!function(t,i){if("function"==typeof define&&define.amd)define(["exports"],i);else if(void 0!==a)i(a);else{var e={};i(e),t.DrawCircle=e}}(this,function(t){"use strict";function s(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function a(t,i){for(var e=0;e<i.length;e++){var a=i[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,i,e){return i&&a(t.prototype,i),e&&a(t,e),t}}(),e=function(){function o(t,i,e,a){var r;if(function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,o),t&&i&&e){this.canvas=document.querySelector(t),this.ctx=this.canvas.getContext("2d"),this.data=i||[],this.accuracy=e||0;var n=(s(r={start:0,sum:0,count:0,space:0,top:0,w:400<window.innerWidth?400:window.innerWidth,x:0,y:0},"space",30),s(r,"outer_colors",["#FFC869","#5499CC","#FF6969","#52CC8F","#b66eff","#c50e18"]),s(r,"center_title","正确率"),s(r,"def_color","#333"),s(r,"text_color","#333"),s(r,"list",["正   确","半   对","错   误","待批改","其它"]),r);Object.assign(this,n,a),console.log(this),this.init()}else alert("id, data, accuracy 为必填参数")}return i(o,[{key:"getRatio",value:function(){var t=this.ctx,i=window.devicePixelRatio||1,e=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;this.ratio=i/e}},{key:"init",value:function(){this.dataCount(),this.getRatio();var t=this.w*this.ratio;this.canvas.width=t,this.canvas.height=t-130*this.ratio,this.x=t/3-10*this.ratio,this.y=t/3,this.outCircle(this.outer_colors,this.canvas.width/4),this.drawCircle("rgba(0,0,0,.1)",0,1,this.canvas.width/6,this.x,this.y),this.drawCenter(),this.drawText(this.outer_colors)}},{key:"drawCenter",value:function(){var t=this.x,i=this.y,e=this.ctx,a=this.canvas.width/7;e.globalCompositeOperation="xor",this.drawCircle("#fff",0,1,a,t,i),e.font=24*this.ratio+"px Arial",e.fillStyle=this.def_color,e.textAlign="center",e.fillText(this.accuracy,t,i-0*this.ratio),e.font=16*this.ratio+"px Arial",e.fillText(this.center_title,t,i+20*this.ratio)}},{key:"drawText",value:function(o){var s=this,c=this.ctx;c.textAlign="left";var l=0;this.data.map(function(t,i){if(t&&0<t){var e=o[i]||o[1],a=s.list[i]||"其它",r=2*s.x,n=s.y-s.canvas.width/6+s.space*s.ratio*l++-2*s.ratio;s.drawCircle(e,0,1,8*s.ratio,r,n),c.fillStyle=s.text_color,c.font=14*s.ratio+"px Arial",c.fillText(a+"： "+t+"人",r+20*s.ratio,n+4*s.ratio,100*s.ratio)}})}},{key:"outCircle",value:function(r,n){var o=this;this.data.map(function(t,i){var e=r[i]||r[1],a=t/o.sum;o.drawCircle(e,o.start,o.start+a,n,o.x,o.y),o.start+=t/o.sum})}},{key:"drawCircle",value:function(t,i,e,a,r,n){var o=this.ctx;o.beginPath(),o.lineWidth=0,o.moveTo(r,n),o.arc(r,n,a,2*Math.PI*i,2*Math.PI*e),o.fillStyle=t,o.lineTo(r,n),o.fill(),o.save()}},{key:"dataCount",value:function(){var i=this;this.data=this.data.slice(0,this.list.length),this.data.map(function(t){i.sum+=t,t&&0<t&&i.count++})}}]),o}();t.default=e})});