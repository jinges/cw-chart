!function(t,i){if("function"==typeof define&&define.amd)define(["exports"],i);else if("undefined"!=typeof exports)i(exports);else{var e={};i(e),t.DrawCircle=e}}(this,function(t){!function(i,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if(void 0!==t)e(t);else{var a={};e(a),i.DrawCircle=a}}(this,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(t,i){for(var e=0;e<i.length;e++){var a=i[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(i,e,a){return e&&t(i.prototype,e),a&&t(i,a),i}}(),e=function(){function t(i,e,a,s){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),i&&e&&a?(this.canvas=document.querySelector(i),this.ctx=this.canvas.getContext("2d"),this.data=e||[],this.accuracy=a||0,this.dataObj=s||{outer_colors:null,inner_colors:null,center_text:null,def_Color:null,list:null},this.init()):alert("id, data, accuracy 为必填参数")}return i(t,[{key:"getRatio",value:function(){var t=window.devicePixelRatio||1;console.log(t),this.ratio=.9*t;var i=window.innerWidth;i<=320?this.ratio=1.2*t:i<=400&&t<3?this.ratio=1.4*t:i>=600&&(this.ratio=2.4*t)}},{key:"init",value:function(){this.outer_colors=this.dataObj.outer_colors||["#52cc8f","#5499cc","#ff6969","#ffc869","#b66eff","#66cb8e","#c50e18"],this.inner_colors=this.dataObj.inner_colors||["#219c4b","#22559c","#ff2e2e","#ff952e","#7e34fe","#3b9b4a","#99080f"],this.center_text=this.dataObj.center_text||"正确率",this.start=0,this.sum=0,this.count=0,this.space=0,this.top=0,this.x=0,this.y=0,this.list=this.dataObj.list||["正   确","半   对","错   误","待批改","其它"],this.def_Color=this.dataObj.def_Color||"#2c333d",this.getRatio(),this.dataCount();var t=window.innerWidth;this.canvas.width=t,this.canvas.height=t-130,this.x=t/3-10,this.y=t/3,this.formatParams(this.outer_colors,this.canvas.width/4),this.formatParams(this.inner_colors,this.canvas.width/6),this.drawCenter(),this.computeSpace(),this.drawText(this.outer_colors)}},{key:"drawCenter",value:function(){var t=this.x,i=this.y,e=this.ctx,a=this.canvas.width/8;this.drawCircle(this.def_Color,0,1,a,t,i),e.font=11*this.ratio+"px Arial",e.fillStyle="#fff",e.textAlign="center",e.fillText(this.accuracy,t,i-2*this.ratio),e.font=7*this.ratio+"px Arial",e.fillText(this.center_text,t,i+8*this.ratio)}},{key:"drawText",value:function(t){var i=this,e=this.ctx,a=!1;this.data.map(function(s,n){var r=a?n-1:n;if(s&&s>0){var o=t[n]||t[1],c=i.list[n]||"其它",h=2*i.x,l=i.y-i.canvas.width/4+i.space+r*i.space*2+i.top;i.drawCircle(o,0,1,4*i.ratio,h,l),e.fillStyle="#fff",e.font=6*i.ratio+"px Arial",e.fillText(c+" "+s+"人",h+24*i.ratio,l+2*i.ratio)}else a=!0})}},{key:"computeSpace",value:function(){var t=this.canvas.width/4*2;this.space=t/(2*this.count),this.space>40&&(this.space=25,this.top=40)}},{key:"formatParams",value:function(t,i){var e=this;this.data.map(function(a,s){var n=t[s]||t[1],r=a/e.sum;a&&a>0?(e.drawCircle(n,e.start,e.start+r,i,e.x,e.y),e.start+=a/e.sum):!0})}},{key:"drawCircle",value:function(t,i,e,a,s,n){var r=this.ctx;r.beginPath(),r.lineWidth=0,r.moveTo(s,n),r.arc(s,n,a,2*Math.PI*i,2*Math.PI*e),r.fillStyle=t,r.lineTo(s,n),r.fill(),r.save()}},{key:"dataCount",value:function(){var t=this;this.data=this.data.slice(0,this.list.length),this.data.map(function(i){t.sum+=i,i&&i>0&&t.count++})}}]),t}();t.default=e})});